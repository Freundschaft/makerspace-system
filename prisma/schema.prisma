// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
  seed     = "tsx prisma/seed.ts"
}

datasource db {
  provider = "mysql"
}

model User {
  id                  String              @id @default(uuid())
  email               String?
  googleId            String              @unique
  role                String?
  enabled             Boolean?
  electronicsRepairs  ElectronicsRepair[]
  carpentryProjects   CarpentryProject[]
}

model ProblemType {
  id        String   @id @default(cuid())
  value     String   @unique
  label     String
  image     String
  index     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model BicycleRepair {
  id              String    @id @default(uuid())
  problemTypes    String    @db.Text @default("[]")
  description     String    @db.Text
  receivedDate    DateTime
  repairedDate    DateTime?
  pickupDate      DateTime?
  ownerPhone      String
  status          RepairStatus @default(PENDING)
  photoPath       String?   @db.Text
  partsUsed       RepairPart[]
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
}

model Part {
  id          String    @id @default(uuid())
  name        String
  description String?   @db.Text
  quantity    Int
  repairs     RepairPart[]
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model RepairPart {
  id              String    @id @default(uuid())
  repair          BicycleRepair @relation(fields: [repairId], references: [id])
  repairId        String
  part            Part      @relation(fields: [partId], references: [id])
  partId          String
  quantity        Int
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  @@unique([repairId, partId])
}

enum RepairStatus {
  PENDING
  IN_PROGRESS
  WAITING_FOR_PARTS
  COMPLETED
  PICKED_UP
  CANCELLED
}

enum RentalStatus {
  ACTIVE
  RETURNED
  OVERDUE
  CANCELLED
}

model BicycleRental {
  id            String       @id @default(uuid())
  renterName    String
  renterPhone   String
  renterEmail   String?
  bicycleId     String
  startDate     DateTime
  endDate       DateTime
  actualReturnDate DateTime?
  status        RentalStatus @default(ACTIVE)
  notes         String?      @db.Text
  signature     String?      @db.Text
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt
}

enum TeamMemberStatus {
  ACTIVE
  INACTIVE
}

model TeamMember {
  id           String          @id @default(uuid())
  familyName   String
  givenNames   String
  nationality  String
  photoPath    String?         @db.Text
  status       TeamMemberStatus @default(ACTIVE)
  startDate    DateTime
  endDate      DateTime?
  department   String
  email        String          @unique
  phone        String
  homeAddress  String?         @db.Text
  dateOfBirth  DateTime
  legalStatus  String
  createdAt    DateTime        @default(now())
  updatedAt    DateTime        @updatedAt
}

enum ElectronicsRepairStatus {
  UNCHECKED
  CHECKED
  IN_PROGRESS
  READY_FOR_PICKUP
  DONE
  PICKED_UP
  NO_WAY_TO_FIX
}

enum ElectronicsCategory {
  PHONE
  TABLET
  HEADPHONES
  HEATER
  SPEAKER
  HAIR_CLIPPER
  COOLER
  POWER_BANK
  KETTLE
  LAPTOP
  MULTI_SOCKET
  PIZZA_PAN_CABLE
  PAN
  GLASSES
  AUX
  WATCH
  ADAPTOR
  HANDSFREE
  CABLE
  HAIR_CUTTER
  HAIR_DRYER
  FAN
  PRINTER
  ELECTRONIC_CIGARETTE
  STOVE
  PIZZA_PAN
  WIRELESS
  EAR_PAD
  SMART_WATCH
  XBOX360
  TOASTER
  TAILOR_MACHINE
  BATTERY
  PHONE_CASE
  BRACELET
  TESBIH
  HAND_MIXER
  COMPUTER
  SEWING_MACHINE
  WATER_HEATER
  PUMP
  KEYBOARD
  PLUG
  WATER_BOILER
  THERAPY
  COFFEE_MAKER
  KITCHEN
  BOARD
  MAT
  RADIO
  VACUUM_CLEANER
  OTHER
}

model ElectronicsRepair {
  id           String                   @id @default(uuid())
  repairId     Int                      @unique @default(autoincrement())
  customerName String
  category     ElectronicsCategory
  item         String?
  whatsapp     String?
  serialNumber String?                  @db.Text
  status       ElectronicsRepairStatus  @default(UNCHECKED)
  repairable   Boolean?
  notes        String?                  @db.Text
  photoPath    String?                  @db.Text
  createdDate  DateTime                 @default(now())
  repairerId   String?
  repairer     User?                    @relation(fields: [repairerId], references: [id])
  createdAt    DateTime                 @default(now())
  updatedAt    DateTime                 @updatedAt
}

enum CarpentryCustomerType {
  PRIVATE_PERSON
  ORGANIZATION
  BARBERSHOP
  HOUSE
}

enum CarpentryOrderType {
  REPAIR_ORDER
  PROJECT
}

enum CarpentryGender {
  FEMALE
  MALE
}

model CarpentryProject {
  id                String                  @id @default(uuid())
  date              DateTime
  acceptedBy        String?
  customerType      CarpentryCustomerType?
  organizationName  String?                 @db.Text
  customerName      String?
  phoneNumber       String?                 @db.Text
  gender            CarpentryGender?
  orderType         CarpentryOrderType?
  timeNeeded        Int?
  itemToRepair      String?                 @db.Text
  problemDescription String?                @db.Text
  projectDescription String?                @db.Text
  materialCosts     Decimal?                @db.Decimal(10, 2)
  paidByCustomer    Boolean?
  photoPath         String?                 @db.Text
  assignedToId      String?
  assignedTo        User?                   @relation(fields: [assignedToId], references: [id])
  createdAt         DateTime                @default(now())
  updatedAt         DateTime                @updatedAt
}

